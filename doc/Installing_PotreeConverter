Potree Converter build instructions
=======================================

In addition to liblas and its requirements (proj, tiff, geotiff, gdal and laszip) we also need boost 1.55

For installing liblas and its dependencies as well as boost 1.55 we recommend looking at https://github.com/NLeSC/pointcloud-benchmark/tree/master/install for different methods of installing liblas (and other point cloud related software) in different OSs
git clone https://github.com/oscarmartinezrubiorg/PotreeConverter.git
# Assuming the code is downloaded in /opt/PotreeConverter/
cd /opt/PotreeConverter/
mkdir build
mkdir makefiles 
cd makefiles
cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/opt/PotreeConverter/build -DBoost_DIR=/opt/boost_1_55_0/build -DBoost_INCLUDE_DIR=/opt/boost_1_55_0/build/include -DBoost_INCLUDE_DIRS=/opt/boost_1_55_0/build/include -DBoost_LIBRARY_DIRS=/opt/boost_1_55_0/build/lib -DLIBLAS_INCLUDE_DIR=/opt/liblas/build/include -DLIBLAS_LIBRARY=/opt/liblas/build/lib/liblas.so
make 
make install

Possible issues
---------------
There are a few of issues that may arise with the installation of PotreeConverter

1 - The specified boost is ignored. In order to force the a certain version of Boost we modify the CMakeLists.txt 

find_package(Boost 1.55.0 COMPONENTS system thread filesystem program_options regex REQUIRED)

2 - We may need to add #include <limits> in PotreeConverter/include/AABB.h

3 - If it complaing about the CPLMutexHolder it means that GDAL is not found by the linker. This may happen with custom installations. 
To solve this you need to make sure that the next environmental variables are set before run the cmake command:

#Change these one according to your paths
export LIBLAS_HOME=/home/oscar/sw/liblas/build
export LASZIP_HOME=/home/oscar/sw/laszip-2.1.0/build
export BOOST_HOME=/usr/local
export GDAL_HOME=/home/oscar/sw/gdal-trunk/build
# Run these exports now
export CWD_HOME=`pwd`
export BOOST_ROOT=$BOOST_HOME
export CMAKE_MODULE_PATH=$LIBLAS_HOME:${CMAKE_MODULE_PATH}
export LD_RUN_PATH=$GDAL_HOME/lib:$BOOST_HOME/lib:$LASZIP_HOME/lib:$LIBLAS_HOME/lib:$CWD_HOME/lib:$LD_RUN_PATH
export LD_LIBRARY_PATH=$GDAL_HOME/lib:$BOOST_HOME/lib:$LASZIP_HOME/lib:$LIBLAS_HOME/lib:$CWD_HOME/lib:$LD_LIBRARY_PATH
export LIBRARY_PATH=$GDAL_HOME/lib:$BOOST_HOME/lib:$LASZIP_HOME/lib:$LIBLAS_HOME/lib:$CWD_HOME/lib:$LIBRARY_PATH
export C_INCLUDE_PATH=$LIBLAS_HOME/include/liblas/capi:${C_INCLUDE_PATH}
export LDFLAGS="${LDFLAGS} -L$GDAL_HOME/lib -L$BOOST_HOME/lib -L$LIBLAS_HOME/lib -L$LASZIP_HOME/lib -llas_c -llaszip"

4 - If you get linking compiler of undefined reference to `boost::filesystem::detail::copy_file:

Add in PotreeConverter/include/stuff.h the following line just before #include <boost/filesystem.hpp>
 #define BOOST_NO_CXX11_SCOPED_ENUMS

5 - It need a new compiler. Once installed use the following option in cmake (chaning the paths according to your installation):
 -DCMAKE_CXX_COMPILER=/cm/shared/package/gcc/4.9.0/bin/c++ -DCMAKE_C_COMPILER=/cm/shared/package/gcc/4.9.0/bin/gcc -DCMAKE_LINKER=/cm/shared/package/gcc/4.9.0/bin/ld -DCMAKE_NM=/cm/shared/package/gcc/4.9.0/bin/nm -DCMAKE_OBJCOPY=/cm/shared/package/gcc/4.9.0/bin/objcopy -DCMAKE_OBJDUMP=/cm/shared/package/gcc/4.9.0/bin/objdump -DCMAKE_RANLIB=/cm/shared/package/gcc/4.9.0/bin/ranlib -DCMAKE_STRIP=/cm/shared/package/gcc/4.9.0/bin/strip
